### Как запустить?

Работа скриптов запуска и приложения была протестирована на `Debian GNU/Linux 11 (bullseye)` и `node V18.10.0`

Поддерживаются следующие команды:

- `npm run-script start` - соберет проект, запустит сервер `mongodb-memory-server` и затем запустит приложение (В консоль будут логироваться входящие запросы с клиента, это сделано для удобства демонстрации работы приложения).
- `npm run-script test` - выполнит все тесты
- `npm run-script build` - выполнит сборку проекта в папку **.build**.
- `npm run-script develop` - запустит режим разработки с режимом отслеживания изменения файлов и последующией пересборкой и перезапуском (**nodemon**) приложения.

### Структура директорий

projcect
├── client # Статичные страницы отдаваемые express с http://localhost:8000/
├── server # Реализация сервера принимающего запросы к http://localhsot:8001/track
├── tracker # Реализация Tracker
├── README
├── index.ts
├── Gulpfile.js # Таски для сборки проекта
├── rollup.tracker.js # Конфигурация rollup для Tracker
├── config.node.json # Общая конфигурация для client/server
├── config.tracker.json # Конфигурация для настройки поведения Tracker (интервал отправки и.т д)
├── tsconfig.json
├── tsconfig.node.json # Настройки транслятора для server/client
└── tsconfig.tracker.json # Настройки транслятора для Tracker

```

### Особенности реализации

- Покрыто тестами поведение трекера и запрос к `/track` с использованием `mocha` , `chai` `sinon` и `jsdom`
- Tracker собирается как **iife** для оптимизации количества **HTTP** запросов и скорости отдачи.
- Реализация **server** и **client** логически разделены, что дает возможность в будушем разнести их по отдельным репозиториям (Скрипт одноврменного запуска обоих реализаций после сборки расположен в `.build/index.js`).
- Для сборки и других задач использовался **Gulp** (Можно было обойтись `npm run-script`, но `gulp` более гибкий и позволяет оптимизировать сборку с **serial** и **parallel** запуском).
- Использовался `mongodb-memory-server` для простоты (В нормальном проекте для настройки окружения для разработки желательно использовать `docker-compose` или `vagrant`)
- Запрос к  `http://localhost:8001/track` был приведен к простому запросу, что позволило отключить **preflight** и снизить нагрузку на сервер.
- Запросы к `http://localhost:8001/track` валидируются в `/server/requests/TrackRequest/TrackEventRequest.ts` и позволяют настроить варианты валидации (длину event имени и т.д.) (В данной реализации я сознательно для простоты не выносил конфигурационные параметры длины имени, максимального количества тэгов и т.д.)
- Реализована отправка даных на сервер до перехода на следуюшую страницу после клика по ссылке и закрытии окна браузера/вкладки с использованием обычного **перехвата** клика (Моя реализация простая, но если требуется максимально не терять данные, то нужно использовать `localStorage`, `indexDB`, а еще лучше если проект позволяет установить `WEB Worker API` скрипт, то использовать его).
- Реализована отдача кода трекера по `http://localhost:8001/` c отдачей **HTTP** заголовка **etag**, так как адрес скрипта не изменяется, то в будушем будут проблемы с обновлением трекера, если он закэшируется браузером. (Я выполнил данный пункт по условиям тз и установил правильные заголовок **CORS**, но отдача статики с потенциального rest сервера, конечно, не очень хорошая идея. В реальном приложение нужно вынести всю статику на отдельный сервер, а еще лучше решением будет использовать `CDN`)
- Ответ от `http://localhost:8001/track` со статусом `200` отдается сразу. (Для простоты моя реализация не ждет ответа от `mongodb`, но в реальном приложении нужно использовать очередь и демона который слушает события. Это позволит быстрее принимать события от клиента и надежнее сохранить данные в БД из-за возможности отработки ошибок и повторной попытки вставки)

```
